<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Tropo | Cisco</title>

    <meta name="description" content="Source code generated using layoutit.com">
    <meta name="author" content="LayoutIt!">

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
	<style>
	html{overflow-y: scroll;
overflow-x: hidden;}
	#header 
	{
		width : 100%;
		height:100px;
		background-color : #0076A2;
		color:white;
	}
	#header .logo
	{
		margin-top:50px;
		margin-left:-120px;
	}
	#header .logo2
	{	 
		height:150px;	
		margin-top:5px;
		margin-left:150px;
		margin-bottom:20px;
	}
	#header .shipped
	{	 
		height:40px;	
		margin-top:50px;
		margin-left:120px;
		margin-bottom:20px;
	}
	#header .text
	{	 	
		margin-top:50px;
		margin-left:-150px;
	}
	.container-fluid
	{
		width:1100px;
		padding:20px;
	}
	#errmsg, #errmsg1, #errmsg2
	{
	margin-left:-20px;
		color: red;
	}
	</style>
  </head>
  <body>
	<div id="header">
	<div class="row">
	<div class="col-md-6">
	<div class="row">
	<div class="col-md-3"><img class = "logo2" src="image/shipped.png" /></div>
	<div class="col-md-3"><img  class = "shipped" src="http://shipped-cisco.com/images/logo-white.png" /></div>
	
	</div>
	</div>
	<div class="col-md-3">
	<h1 class="text">WebAPI Sample</h1>
	</div>
	<div class="col-md-3">
		<img class = "logo" src="image/logo.png" />
	</div>
	</div>
		
	</div>
	<div class="container-fluid">
	<div class="row">
		<div class="col-md-12">
			<div class="tabbable" id="tabs-82214">
				<ul class="nav nav-tabs">
					<li class="active">
						<a href="#panel-266101" data-toggle="tab">View Contact</a>
					</li>
					<li >
						<a href="#panel-769963" data-toggle="tab">Add Contact</a>
					</li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane active" id="panel-266101">
						<div class="row">
		<div class="col-md-12">
			<table class="table">
				<thead>
					<tr>
						<th>
							#
						</th>
						<th>
							Name
						</th>
						<th>
							Number
						</th>
						<th>
							Active
						</th>
					</tr>
				</thead>
				<tbody id="tbody">			 
					 
				</tbody>
			</table>
		</div>
	</div>
					</div>
					<div class="tab-pane" id="panel-769963">
						<div class="row">
		<div class="col-md-12">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">
						Add new contact to application
					</h3>
				</div>
				<div class="panel-body">
					<div class="row">
		<div class="col-md-12">
			<form role="form" id="frmContact">
				<div class="row">
			<div class="col-md-8">
				<div class="form-group">
					<input type="text" class="form-control" id="txtFirst"  placeholder="Enter first name" maxlength="25"/>
				</div>
				</div>
							<div class="col-md-4"><span id="errmsg1"></span></div>
				</div>
				<div class="row">
			<div class="col-md-8">
				<div class="form-group">					 
					 
					<input type="text" class="form-control" id="txtLast"  placeholder="Enter last name" maxlength="25"/>
				</div>
				</div>
							<div class="col-md-4"><span id="errmsg2"></span></div>
				</div>
				<div class="row">
			<div class="col-md-8">
				<div class="form-group">
					 
					<input type="text" class="form-control" id="txtPhone" placeholder="Enter phone number" maxlength="12"/>
				</div>
				</div>
							<div class="col-md-4"><span id="errmsg"></span></div>
				</div>
				<button id="addMe" type="submit" class="btn btn-primary btn-large">
					Add User
				</button>
			</form>
		</div>
		
	</div>
				</div>
				<div class="panel-footer">
					Copyright Cisco @ 2015
				</div>
			</div>
		</div>
	</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/scripts.js"></script>
	<script>
		$(window).load(function() {
		var htmlcode = '';
		 $.ajax({
            type: 'GET',
            url: '/contacts',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
			success: function(msg){
				debugger;
				j = msg.length - 1;
					for(i=j;i>=0;i--)
					{
						console.log(msg[i]);
						var k = msg[i];
						for(n in k)
						{
							//console.log(k[n].namechoices+"  "+k[n].number);
							htmlcode += returnhtml(i,k[n].namechoices,k[n].number);
						}
					}
					debugger;
					$("#tbody").html(htmlcode);
				},
				error:function(jqXHR, textStatus, errorThrown){
					debugger;
                 alert(textStatus);
               }
        });
		function returnhtml(i,name,number)
		{
			debugger;
			i = i+1;
			return '<tr><td>'+i+'</td><td>'+name+'</td><td>'+number+'</td><td>Active</td></tr>';
		}
		
		 function validateForm()
		 {
			if($("#txtFirst").val().trim()=="")
			{
				$("#errmsg1").html("First name is required").show(1000).fadeOut(5000);
				return false;	
			}
			else if($("#txtLast").val().trim()=="")
			{
				$("#errmsg2").html("Last name is required").show(1000).fadeOut(5000);
				return false;
			}
			else if($("#txtPhone").val().trim()=="")
			{
				$("#errmsg").html("Phone Number is required").show(1000).fadeOut(5000);
				return false;
			}
			return true;
		}
		$("#addMe").click(function(){
		if(!validateForm())
		{
			return false;
		}
		//ajax call
			var datavalue ={};
			var data ={};
			data.namechoices = $("#txtFirst").val()+", "+$("#txtFirst").val()+" "+$("#txtLast").val();
			data.number = $("#txtPhone").val();
			
			datavalue[$("#txtFirst").val()] = data;
			debugger;								
			console.log('datavalue---',datavalue);
		
				
				 $.ajax({
            type: 'POST',
            url: '/contacts',
            data: JSON.stringify(datavalue),
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
			success: function(){
				debugger;
					//saves
				},
      error:function(jqXHR, textStatus, errorThrown){
	  debugger;
                       alert(textStatus);
                        }
        });
		});
		
		});
		
		$(document).ready(function () {
		  //called when key is pressed in textbox
		  $("#txtPhone").keypress(function (e) {
			 //if the letter is not digit then display error and don't type anything
			 if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
				//display error message
				$("#errmsg").html("Numeric Only").show(1000).fadeOut(5000);
					   return false;
			}
		   });
		   
		   $("#txtFirst").keypress(function (e) {
			
				$("#errmsg1").hide();
					 
		   });
		   
		   $("#txtLast").keypress(function (e) {
			
				$("#errmsg2").hide();
					
		   });
		});
	</script>
  </body>
</html>